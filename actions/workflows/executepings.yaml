---
version: '2.0'

napalmdemo.execute_pings:
  type: direct
  tasks:
    task1:
      action: napalmdemo.getcombined
      publish:
        fulllist: <% task(task1).result.result %>
      on-success:
        - task2
    
    task2:
      with-items: 
        - thing in <% $.fulllist %>
      
      action: napalmdemo.napalmpinger ndevice="<% str($.thing.get('device')) %>" nping="<% str($.thing.get('ip')) %>"
