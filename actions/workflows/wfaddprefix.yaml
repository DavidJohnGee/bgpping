---
version: '2.0'

napalmdemo.wf_add_prefix:
  type: direct
  input:
    - devices
    - prefixes
    - test
    - test_desc
  tasks:

    task1:
      action: napalmdemo.add_ping_node ip=<% $.test %> desc=<% $.test_desc %>
      on-complete:
        - task2 

    task2:
      with-items:
        - dev in <% $.devices %>
      action: napalmdemo.wfaddprefixsub1 device=<% $.dev %> prefixes=<% $.prefixes %>
      on-success:
        - validate

    validate:
      action: napalmdemo.execute_pings

